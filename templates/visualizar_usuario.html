{% extends "base.html" %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card shadow">
                <div class="card-body p-4">
                    <h2 class="text-center mb-4">
                        <i class="bi bi-person-badge"></i> Dados do Usuário
                    </h2>

                    <!-- Mensagens flash -->
                    {% with messages = get_flashed_messages(with_categories=true) %}
                        {% if messages %}
                            {% for category, message in messages %}
                                <div class="alert alert-{{ category }} alert-dismissible fade show">
                                    {{ message }}
                                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                                </div>
                            {% endfor %}
                        {% endif %}
                    {% endwith %}

                    <div class="user-profile">
                        <!-- Cabeçalho com tipo de usuário -->
                        <div class="text-end mb-3">
                            <span class="badge rounded-pill bg-{{ 'primary' if usuario.tipo == 'instrutor' else 'success' }}">
                                {{ 'Instrutor' if usuario.tipo == 'instrutor' else 'Aluno' }}
                            </span>
                        </div>

                        <!-- Seção de Dados Pessoais -->
                        <h5 class="mb-3 border-bottom pb-2">
                            <i class="bi bi-person-lines-fill"></i> Dados Pessoais
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nome Completo</label>
                                <div class="form-control-plaintext">{{ usuario.nome_completo }}</div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="form-label">CPF</label>
                                <div class="form-control-plaintext">{{ usuario.cpf[:3] }}.{{ usuario.cpf[3:6] }}.{{ usuario.cpf[6:9] }}-{{ usuario.cpf[9:] }}</div>
                            </div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label">Endereço</label>
                            <div class="form-control-plaintext">{{ usuario.endereco }}</div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Telefone</label>
                                <div class="form-control-plaintext">
                                    {% if usuario.telefone|length == 11 %}
                                        ({{ usuario.telefone[:2] }}) {{ usuario.telefone[2:7] }}-{{ usuario.telefone[7:] }}
                                    {% else %}
                                        {{ usuario.telefone }}
                                    {% endif %}
                                </div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="form-label">Peso</label>
                                <div class="form-control-plaintext">{{ "%.1f kg"|format(usuario.peso) }}</div>
                            </div>
                        </div>

                        <hr class="my-4">

                        <!-- Seção de Dados de Acesso -->
                        <h5 class="mb-3 border-bottom pb-2">
                            <i class="bi bi-key-fill"></i> Dados de Acesso
                        </h5>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Nome de Usuário</label>
                                <div class="form-control-plaintext">{{ usuario.username }}</div>
                            </div>

                            <div class="col-md-6 mb-3">
                                <label class="form-label">Data de Cadastro</label>
                                <div class="form-control-plaintext">
                                    {{ usuario.data_cadastro.strftime('%d/%m/%Y') }}
                                </div>
                            </div>
                        </div>

                        <!-- Botões de Ação -->
                        <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
                            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary me-md-2">
                                <i class="bi bi-arrow-left"></i> Voltar
                            </a>
                            
                            {% if session['user_type'] == 'instrutor' %}
                            <a href="{{ url_for('editar_usuario', user_id=usuario.id) }}" class="btn btn-primary">
                                <i class="bi bi-pencil-square"></i> Editar
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .card {
        border-radius: 10px;
        border: none;
    }
    .form-control-plaintext {
        padding: 0.375rem 0.75rem;
        background-color: #f8f9fa;
        border-radius: 4px;
        min-height: calc(1.5em + 0.75rem + 2px);
    }
    .border-bottom {
        border-color: #dee2e6!important;
    }
    hr {
        opacity: 0.2;
    }
    .badge {
        font-size: 0.9em;
        padding: 0.5em 0.8em;
    }
</style>
{% endblock %}